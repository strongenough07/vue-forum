(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ThreadShow"],{"0621":function(t,e,n){var r=n("9e69"),a=n("d370"),o=n("6747"),c=r?r.isConcatSpreadable:void 0;function s(t){return o(t)||a(t)||!!(c&&t&&t[c])}t.exports=s},"087d":function(t,e){function n(t,e){var n=-1,r=e.length,a=t.length;while(++n<r)t[a+n]=e[n];return t}t.exports=n},"099a":function(t,e){function n(t,e,n){var r=n-1,a=t.length;while(++r<a)if(t[r]===e)return r;return-1}t.exports=n},"0b07":function(t,e,n){var r=n("34ac"),a=n("3698");function o(t,e){var n=a(t,e);return r(n)?n:void 0}t.exports=o},"100e":function(t,e,n){var r=n("cd9d"),a=n("2286"),o=n("c1c9");function c(t,e){return o(a(t,e,r),t+"")}t.exports=c},1290:function(t,e){function n(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}t.exports=n},1368:function(t,e,n){var r=n("da03"),a=function(){var t=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function o(t){return!!a&&a in t}t.exports=o},"1efc":function(t,e){function n(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}t.exports=n},"1f6c":function(t,e,n){"use strict";n("b0c0");var r=n("7a23"),a={class:"post-list"},o={key:0,class:"user-info"},c={href:"#",class:"user-name"},s={href:"#"},i={class:"desktop-only text-small"},u={class:"desktop-only text-small"},d={class:"post-content"},l={class:"col-full"},p={key:1},f=["onClick"],h={class:"post-date text-faded"},b={key:0,class:"edition-info"};function v(t,e,n,v,O,j){var y=Object(r["L"])("AppAvatarImg"),_=Object(r["L"])("PostEditor"),x=Object(r["L"])("fa"),m=Object(r["L"])("AppDate");return Object(r["C"])(),Object(r["h"])("div",a,[(Object(r["C"])(!0),Object(r["h"])(r["a"],null,Object(r["J"])(n.posts,(function(e){var n;return Object(r["C"])(),Object(r["h"])("div",{class:"post",key:e.id},[j.userById(e.userId)?(Object(r["C"])(),Object(r["h"])("div",o,[Object(r["i"])("a",c,Object(r["Q"])(j.userById(e.userId).name),1),Object(r["i"])("a",s,[Object(r["m"])(y,{class:"avatar-large",src:j.userById(e.userId).avatar},null,8,["src"])]),Object(r["i"])("p",i,Object(r["Q"])(j.userById(e.userId).postsCount)+" posts ",1),Object(r["i"])("p",u,Object(r["Q"])(j.userById(e.userId).threadsCount)+" threads ",1)])):Object(r["g"])("",!0),Object(r["i"])("div",d,[Object(r["i"])("div",l,[O.editing===e.id?(Object(r["C"])(),Object(r["f"])(_,{key:0,post:e,onSave:j.handleUpdate},null,8,["post","onSave"])):(Object(r["C"])(),Object(r["h"])("p",p,Object(r["Q"])(e.text),1))]),e.userId===t.$store.state.auth.authId?(Object(r["C"])(),Object(r["h"])("a",{key:0,onClick:Object(r["cb"])((function(t){return j.toggleEditMode(e.id)}),["prevent"]),href:"#",style:{"margin-left":"auto","padding-left":"10px"},class:"link-unstyled",title:"Make a change"},[Object(r["m"])(x,{icon:"pencil-alt"})],8,f)):Object(r["g"])("",!0)]),Object(r["i"])("div",h,[null!==(n=e.edited)&&void 0!==n&&n.at?(Object(r["C"])(),Object(r["h"])("div",b,"edited")):Object(r["g"])("",!0),Object(r["m"])(m,{timestamp:e.publishedAt},null,8,["timestamp"])])])})),128))])}var O=n("5530"),j=n("c302"),y=n("5502"),_={components:{PostEditor:j["a"]},props:{posts:{required:!0,type:Array}},data:function(){return{editing:null}},computed:{users:function(){return this.$store.state.users.items}},methods:Object(O["a"])(Object(O["a"])({},Object(y["b"])("posts",["updatePost"])),{},{userById:function(t){return this.$store.getters["users/user"](t)},toggleEditMode:function(t){this.editing=t===this.editing?null:t},handleUpdate:function(t){this.updatePost(t.post),this.editing=null}})};_.render=v;e["a"]=_},"1fc8":function(t,e,n){var r=n("4245");function a(t,e){var n=r(this,t),a=n.size;return n.set(t,e),this.size+=n.size==a?0:1,this}t.exports=a},2286:function(t,e,n){var r=n("85e3"),a=Math.max;function o(t,e,n){return e=a(void 0===e?t.length-1:e,0),function(){var o=arguments,c=-1,s=a(o.length-e,0),i=Array(s);while(++c<s)i[c]=o[e+c];c=-1;var u=Array(e+1);while(++c<e)u[c]=o[c];return u[e]=n(i),r(t,this,u)}}t.exports=o},2478:function(t,e,n){var r=n("4245");function a(t){return r(this,t).get(t)}t.exports=a},2524:function(t,e,n){var r=n("6044"),a="__lodash_hash_undefined__";function o(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?a:e,this}t.exports=o},"253c":function(t,e,n){var r=n("3729"),a=n("1310"),o="[object Arguments]";function c(t){return a(t)&&r(t)==o}t.exports=c},"28c9":function(t,e){function n(){this.__data__=[],this.size=0}t.exports=n},"2b03":function(t,e){function n(t,e,n,r){var a=t.length,o=n+(r?1:-1);while(r?o--:++o<a)if(e(t[o],o,t))return o;return-1}t.exports=n},"2eaa":function(t,e,n){var r=n("d612"),a=n("8db3"),o=n("5edf"),c=n("7948"),s=n("b047f"),i=n("c584"),u=200;function d(t,e,n,d){var l=-1,p=a,f=!0,h=t.length,b=[],v=e.length;if(!h)return b;n&&(e=c(e,s(n))),d?(p=o,f=!1):e.length>=u&&(p=i,f=!1,e=new r(e));t:while(++l<h){var O=t[l],j=null==n?O:n(O);if(O=d||0!==O?O:0,f&&j===j){var y=v;while(y--)if(e[y]===j)continue t;b.push(O)}else p(e,j,d)||b.push(O)}return b}t.exports=d},"34ac":function(t,e,n){var r=n("9520"),a=n("1368"),o=n("1a8c"),c=n("dc57"),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,u=Function.prototype,d=Object.prototype,l=u.toString,p=d.hasOwnProperty,f=RegExp("^"+l.call(p).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(t){if(!o(t)||a(t))return!1;var e=r(t)?f:i;return e.test(c(t))}t.exports=h},3698:function(t,e){function n(t,e){return null==t?void 0:t[e]}t.exports=n},"3b4a":function(t,e,n){var r=n("0b07"),a=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();t.exports=a},4245:function(t,e,n){var r=n("1290");function a(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}t.exports=a},"47f5":function(t,e,n){var r=n("2b03"),a=n("d9a8"),o=n("099a");function c(t,e,n){return e===e?o(t,e,n):r(t,a,n)}t.exports=c},"49f4":function(t,e,n){var r=n("6044");function a(){this.__data__=r?r(null):{},this.size=0}t.exports=a},"5c69":function(t,e,n){var r=n("087d"),a=n("0621");function o(t,e,n,c,s){var i=-1,u=t.length;n||(n=a),s||(s=[]);while(++i<u){var d=t[i];e>0&&n(d)?e>1?o(d,e-1,n,c,s):r(s,d):c||(s[s.length]=d)}return s}t.exports=o},"5e2e":function(t,e,n){var r=n("28c9"),a=n("69d5"),o=n("b4c0"),c=n("fba5"),s=n("67ca");function i(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}i.prototype.clear=r,i.prototype["delete"]=a,i.prototype.get=o,i.prototype.has=c,i.prototype.set=s,t.exports=i},"5edf":function(t,e){function n(t,e,n){var r=-1,a=null==t?0:t.length;while(++r<a)if(n(e,t[r]))return!0;return!1}t.exports=n},6044:function(t,e,n){var r=n("0b07"),a=r(Object,"create");t.exports=a},6747:function(t,e){var n=Array.isArray;t.exports=n},"67ca":function(t,e,n){var r=n("cb5a");function a(t,e){var n=this.__data__,a=r(n,t);return a<0?(++this.size,n.push([t,e])):n[a][1]=e,this}t.exports=a},"69d5":function(t,e,n){var r=n("cb5a"),a=Array.prototype,o=a.splice;function c(t){var e=this.__data__,n=r(e,t);if(n<0)return!1;var a=e.length-1;return n==a?e.pop():o.call(e,n,1),--this.size,!0}t.exports=c},"72f0":function(t,e){function n(t){return function(){return t}}t.exports=n},7948:function(t,e){function n(t,e){var n=-1,r=null==t?0:t.length,a=Array(r);while(++n<r)a[n]=e(t[n],n,t);return a}t.exports=n},"79bc":function(t,e,n){var r=n("0b07"),a=n("2b3e"),o=r(a,"Map");t.exports=o},"7a48":function(t,e,n){var r=n("6044"),a=Object.prototype,o=a.hasOwnProperty;function c(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}t.exports=c},"7b83":function(t,e,n){var r=n("7c64"),a=n("93ed"),o=n("2478"),c=n("a524"),s=n("1fc8");function i(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}i.prototype.clear=r,i.prototype["delete"]=a,i.prototype.get=o,i.prototype.has=c,i.prototype.set=s,t.exports=i},"7c64":function(t,e,n){var r=n("e24b"),a=n("5e2e"),o=n("79bc");function c(){this.size=0,this.__data__={hash:new r,map:new(o||a),string:new r}}t.exports=c},"7ed2":function(t,e){var n="__lodash_hash_undefined__";function r(t){return this.__data__.set(t,n),this}t.exports=r},"85e3":function(t,e){function n(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}t.exports=n},"8db3":function(t,e,n){var r=n("47f5");function a(t,e){var n=null==t?0:t.length;return!!n&&r(t,e,0)>-1}t.exports=a},"8f3b":function(t,e,n){"use strict";n.r(e);n("b0c0");var r=n("7a23"),a={key:0,class:"col-large push-top"},o=Object(r["l"])(" Edit Thread "),c=Object(r["l"])(" By "),s={href:"#",class:"link-unstyled"},i=Object(r["l"])(", "),u=Object(r["l"])(". "),d={style:{float:"right","margin-top":"2px"},class:"hide-mobile text-faded text-small"},l={key:1,class:"text-center",style:{"margin-bottom":"50px"}},p=Object(r["l"])("Sign In"),f=Object(r["l"])(" or "),h=Object(r["l"])("Register"),b=Object(r["l"])(" to reply. ");function v(t,e,n,v,O,j){var y,_,x=Object(r["L"])("router-link"),m=Object(r["L"])("AppDate"),g=Object(r["L"])("post-list"),w=Object(r["L"])("post-editor");return t.asyncDataStatus_ready?(Object(r["C"])(),Object(r["h"])("div",a,[Object(r["i"])("h1",null,[Object(r["l"])(Object(r["Q"])(j.thread.title)+" ",1),j.thread.userId===(null===(y=t.authUser)||void 0===y?void 0:y.id)?(Object(r["C"])(),Object(r["f"])(x,{key:0,to:{name:"ThreadEdit",id:this.id},class:"btn-green btn-small",tag:"button"},{default:Object(r["Z"])((function(){return[o]})),_:1},8,["to"])):Object(r["g"])("",!0)]),Object(r["i"])("p",null,[c,Object(r["i"])("a",s,Object(r["Q"])(null===(_=j.thread.author)||void 0===_?void 0:_.name),1),i,Object(r["m"])(m,{timestamp:j.thread.publishedAt},null,8,["timestamp"]),u,Object(r["i"])("span",d,Object(r["Q"])(j.thread.repliesCount)+" replies by "+Object(r["Q"])(j.thread.contributorsCount)+" contributors",1)]),Object(r["m"])(g,{posts:j.threadPosts},null,8,["posts"]),t.authUser?(Object(r["C"])(),Object(r["f"])(w,{key:0,onSave:j.addPost},null,8,["onSave"])):(Object(r["C"])(),Object(r["h"])("div",l,[Object(r["m"])(x,{to:{name:"SignIn",query:{redirectTo:t.$route.path}}},{default:Object(r["Z"])((function(){return[p]})),_:1},8,["to"]),f,Object(r["m"])(x,{to:{name:"Register",query:{redirectTo:t.$route.path}}},{default:Object(r["Z"])((function(){return[h]})),_:1},8,["to"]),b]))])):Object(r["g"])("",!0)}n("99af"),n("4de4"),n("d81d"),n("96cf");var O=n("1da1"),j=n("5530"),y=n("1f6c"),_=n("c302"),x=n("5502"),m=n("cae2"),g=n("08b7"),w=n("ceac"),k=n.n(w),C={name:"ThreadShow",components:{PostList:y["a"],PostEditor:_["a"]},mixins:[m["a"]],props:{id:{required:!0,type:String}},setup:function(){var t=Object(g["a"])(),e=t.addNotification;return{addNotification:e}},computed:Object(j["a"])(Object(j["a"])({},Object(x["c"])("auth",["authUser"])),{},{threads:function(){return this.$store.state.threads.items},posts:function(){return this.$store.state.posts.items},thread:function(){return this.$store.getters["threads/thread"](this.id)},threadPosts:function(){var t=this;return this.posts.filter((function(e){return e.threadId===t.id}))}}),methods:Object(j["a"])(Object(j["a"])(Object(j["a"])(Object(j["a"])({},Object(x["b"])("threads",["fetchThread"])),Object(x["b"])("users",["fetchUsers"])),Object(x["b"])("posts",["fetchPosts","createPost"])),{},{fetchPostsWithUsers:function(t){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.fetchPosts({ids:t,onSnapshot:function(t){var n,r=t.isLocal,a=t.previousItem;e.asyncDataStatus_ready&&!r&&(null===a||void 0===a||!a.edited||null!==a&&void 0!==a&&null!==(n=a.edited)&&void 0!==n&&n.at)&&e.addNotification({message:"Thread recently updated",timeout:5e3})}});case 2:return r=n.sent,a=r.map((function(t){return t.userId})).concat(e.thread.userId),n.next=6,e.fetchUsers({ids:a});case 6:case"end":return n.stop()}}),n)})))()},addPost:function(t){var e=Object(j["a"])(Object(j["a"])({},t.post),{},{threadId:this.id});this.createPost(e)}}),created:function(){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchThread({id:t.id,onSnapshot:function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(n){var r,a,o,c,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=n.isLocal,a=n.item,o=n.previousItem,t.asyncDataStatus_ready&&!r){e.next=3;break}return e.abrupt("return");case 3:if(c=k()(a.posts,o.posts),s=c.length>0,!s){e.next=10;break}return e.next=8,t.fetchPostsWithUsers(c);case 8:e.next=11;break;case 10:t.addNotification({message:"Thread recently updated",timeout:5e3});case 11:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()});case 2:return n=e.sent,e.next=5,t.fetchPostsWithUsers(n.posts);case 5:t.asyncDataStatus_fetched();case 6:case"end":return e.stop()}}),e)})))()}};C.render=v;e["default"]=C},"93ed":function(t,e,n){var r=n("4245");function a(t){var e=r(this,t)["delete"](t);return this.size-=e?1:0,e}t.exports=a},a454:function(t,e,n){var r=n("72f0"),a=n("3b4a"),o=n("cd9d"),c=a?function(t,e){return a(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=c},a524:function(t,e,n){var r=n("4245");function a(t){return r(this,t).has(t)}t.exports=a},b047f:function(t,e){function n(t){return function(e){return t(e)}}t.exports=n},b4c0:function(t,e,n){var r=n("cb5a");function a(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}t.exports=a},bbc0:function(t,e,n){var r=n("6044"),a="__lodash_hash_undefined__",o=Object.prototype,c=o.hasOwnProperty;function s(t){var e=this.__data__;if(r){var n=e[t];return n===a?void 0:n}return c.call(e,t)?e[t]:void 0}t.exports=s},c1c9:function(t,e,n){var r=n("a454"),a=n("f3c1"),o=a(r);t.exports=o},c302:function(t,e,n){"use strict";var r=n("7a23"),a={class:"col-full"},o={class:"form-actions"},c={class:"btn-blue"};function s(t,e,n,s,i,u){var d=Object(r["L"])("AppFormField"),l=Object(r["L"])("VeeForm");return Object(r["C"])(),Object(r["h"])("div",a,[(Object(r["C"])(),Object(r["f"])(l,{onSubmit:u.save,key:i.formKey},{default:Object(r["Z"])((function(){return[Object(r["m"])(d,{as:"textarea",name:"text",modelValue:i.postCopy.text,"onUpdate:modelValue":e[0]||(e[0]=function(t){return i.postCopy.text=t}),rows:"10",cols:"30",rules:"required"},null,8,["modelValue"]),Object(r["i"])("div",o,[Object(r["i"])("button",c,Object(r["Q"])(n.post.id?"Update Post":"Submit post"),1)])]})),_:1},8,["onSubmit"]))])}var i=n("5530"),u={props:{post:{type:Object,default:function(){return{text:null}}}},data:function(){return{postCopy:Object(i["a"])({},this.post),formKey:Math.random()}},methods:{save:function(){this.$emit("save",{post:this.postCopy}),this.postCopy.text="",this.formKey=Math.random()}}};u.render=s;e["a"]=u},c584:function(t,e){function n(t,e){return t.has(e)}t.exports=n},cae2:function(t,e,n){"use strict";e["a"]={data:function(){return{asyncDataStatus_ready:!1}},methods:{asyncDataStatus_fetched:function(){this.asyncDataStatus_ready=!0,this.$emit("ready")}}}},cb5a:function(t,e,n){var r=n("9638");function a(t,e){var n=t.length;while(n--)if(r(t[n][0],e))return n;return-1}t.exports=a},cd9d:function(t,e){function n(t){return t}t.exports=n},ceac:function(t,e,n){var r=n("2eaa"),a=n("5c69"),o=n("100e"),c=n("dcbe"),s=o((function(t,e){return c(t)?r(t,a(e,1,c,!0)):[]}));t.exports=s},d370:function(t,e,n){var r=n("253c"),a=n("1310"),o=Object.prototype,c=o.hasOwnProperty,s=o.propertyIsEnumerable,i=r(function(){return arguments}())?r:function(t){return a(t)&&c.call(t,"callee")&&!s.call(t,"callee")};t.exports=i},d612:function(t,e,n){var r=n("7b83"),a=n("7ed2"),o=n("dc0f");function c(t){var e=-1,n=null==t?0:t.length;this.__data__=new r;while(++e<n)this.add(t[e])}c.prototype.add=c.prototype.push=a,c.prototype.has=o,t.exports=c},d9a8:function(t,e){function n(t){return t!==t}t.exports=n},da03:function(t,e,n){var r=n("2b3e"),a=r["__core-js_shared__"];t.exports=a},dc0f:function(t,e){function n(t){return this.__data__.has(t)}t.exports=n},dc57:function(t,e){var n=Function.prototype,r=n.toString;function a(t){if(null!=t){try{return r.call(t)}catch(e){}try{return t+""}catch(e){}}return""}t.exports=a},dcbe:function(t,e,n){var r=n("30c9"),a=n("1310");function o(t){return a(t)&&r(t)}t.exports=o},e24b:function(t,e,n){var r=n("49f4"),a=n("1efc"),o=n("bbc0"),c=n("7a48"),s=n("2524");function i(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}i.prototype.clear=r,i.prototype["delete"]=a,i.prototype.get=o,i.prototype.has=c,i.prototype.set=s,t.exports=i},f3c1:function(t,e){var n=800,r=16,a=Date.now;function o(t){var e=0,o=0;return function(){var c=a(),s=r-(c-o);if(o=c,s>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}t.exports=o},fba5:function(t,e,n){var r=n("cb5a");function a(t){return r(this.__data__,t)>-1}t.exports=a}}]);
//# sourceMappingURL=ThreadShow.0e8d664a.js.map